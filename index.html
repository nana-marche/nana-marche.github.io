<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>nana marche | Home Grid</title>

  <style>
    :root{
      --shell-w: 390px;
      --radius: 28px;

      /* ★壁紙：JSの setWallpaper("wallpaper.jpg") で差し替え */
      --wallpaper: url("");

      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --shadow: 0 30px 90px rgba(0,0,0,.55);

      /* ===== アイコン周り（ここ触るだけで美しく整う） ===== */
      --grid-gap: 18px;        /* ← アイコン間隔（美しく見せる要） */
      --icon-radius: 16px;
      --icon-pad: 8px;         /* ← 枠の中の余白（小さめに） */
      --label-font: 11px;
      --svg-size: 24px;        /* ← 中身の画像サイズ（小さめに） */

      /* ドックも同じ感覚で揃える */
      --dock-gap: 14px;        /* ← ドックのアイコン間隔 */

      /* ページドット */
      --dot-size: 18px;
      --dot-gap: 10px;
      --dot-stroke: rgba(255,255,255,.25);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Noto Sans JP", sans-serif;
      color: var(--text);
      overflow-x:hidden;

      /* PC余白：木目テーブル風（画像無し） */
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(900px 600px at 90% 20%, rgba(255,255,255,.06), transparent 60%),
        linear-gradient(90deg, rgba(0,0,0,.18), rgba(0,0,0,0)),
        repeating-linear-gradient(
          90deg,
          #6b4b2d 0px, #6b4b2d 10px,
          #744f2e 10px, #744f2e 22px,
          #624327 22px, #624327 34px,
          #7a5631 34px, #7a5631 52px
        );

      display:flex;
      justify-content:center;
      align-items:flex-start;
      padding: 18px 12px 40px;
    }

    /* スマホ筐体 */
    .shell{
      width: min(var(--shell-w), 100%);
      border-radius: var(--radius);
      position:relative;
      box-shadow: var(--shadow);

      background:
        linear-gradient(180deg, rgba(0,0,0,.30), rgba(0,0,0,.20)),
        var(--wallpaper),
        radial-gradient(900px 520px at 20% 20%, rgba(0,200,255,.22), transparent 55%),
        radial-gradient(800px 520px at 90% 30%, rgba(255,120,200,.18), transparent 55%),
        radial-gradient(900px 720px at 40% 95%, rgba(140,255,170,.14), transparent 60%),
        linear-gradient(180deg, rgba(8,10,16,.92), rgba(8,10,16,.88));
      background-size: cover, cover, auto, auto, auto, auto;
      background-position: center, center, center, center, center, center;
      background-repeat: no-repeat;
    }

    /* ステータスバー */
    .statusbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding: 14px 16px 10px;
      font-size: 12px;
      letter-spacing:.05em;
      color: rgba(255,255,255,.78);
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,.04);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .brand{
      font-weight: 600;
      letter-spacing: .08em;
      text-transform: lowercase;
    }
    .status-right{
      display:flex;
      gap:10px;
      align-items:center;
      color: rgba(255,255,255,.72);
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: rgba(255,255,255,.55);
      box-shadow: 0 0 0 4px rgba(255,255,255,.06);
    }

    /* メイン */
    .home{
      padding: 14px 16px 16px;
      min-height: 720px;
      display:flex;
      flex-direction:column;
      touch-action: pan-y;
      user-select: none;
    }

    /* iOS対策：アイコン上でもスワイプ判定を通す */
    .home,
    .home *{
      touch-action: pan-y;
      -webkit-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
    }

    .pager{ margin-top: 6px; }

    .pages{
      display:flex;
      gap: 18px;
      overflow-x:auto;
      overflow-y: hidden;
      scroll-snap-type: x mandatory;
      scroll-behavior:smooth;
      scrollbar-width:none;
      padding: 0;

      touch-action: pan-y;
      user-select:none;
      cursor: grab;
    }
    .pages::-webkit-scrollbar{ display:none; }
    .pages.is-dragging{ cursor: grabbing; }

    .page{
      flex: 0 0 100%;
      scroll-snap-align: start;
      padding: 4px 0 0;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--grid-gap);
      margin-top: 2px;
    }

    .app, .icon{ touch-action: pan-y; }

    .app{
      appearance:none;
      border:none;
      background: transparent;
      color: inherit;
      padding:0;
      cursor:pointer;
      text-align:center;
      outline: none;
      -webkit-tap-highlight-color: transparent;
    }

    .icon{
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: var(--icon-radius);
      padding: var(--icon-pad);

      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .icon::before{
      content:"";
      position:absolute; inset:-80% -80%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 62%);
      transform: rotate(15deg);
      opacity:.95;
      pointer-events:none;
    }

    /* ここにPNG/SVGを差し込む（imgでもinline svgでもOK） */
    .svgicon{
      position:relative;
      width: var(--svg-size);
      height: var(--svg-size);
      display:block;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.35));
    }
    .svgicon svg{ width:100%; height:100%; display:block; }
    .svgicon img{
      width:100%;
      height:100%;
      display:block;
      object-fit: contain;
    }

    .label{
      margin-top: 7px;
      font-size: var(--label-font);
      color: rgba(255,255,255,.84);
      letter-spacing:.01em;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* 下部固定 */
    .bottom{
      margin-top: auto;
      padding-top: 18px;
      display:flex;
      flex-direction:column;
      gap: 10px;
      padding-bottom: 14px;
    }

    /* SVGっぽドット */
    .dots{
      display:flex;
      justify-content:center;
      gap: var(--dot-gap);
      padding: 2px 0 4px;
    }
    .pdot{
      width: var(--dot-size);
      height: var(--dot-size);
      border: 1px solid var(--dot-stroke);
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      display:grid;
      place-items:center;
      cursor:pointer;
      padding:0;
      position:relative;
      backdrop-filter: blur(10px);
      -webkit-tap-highlight-color: transparent;
    }
    .pdot svg{ width: 12px; height: 12px; display:block; opacity:.75; }
    .pdot::after{
      content:"";
      position:absolute;
      inset:-6px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.18), transparent 60%);
      opacity:.7;
      pointer-events:none;
    }
    .pdot.is-active{
      background: rgba(255,255,255,.14);
      border-color: rgba(255,255,255,.38);
      box-shadow:
        0 10px 22px rgba(0,0,0,.25),
        0 0 0 4px rgba(255,255,255,.06);
      transform: translateY(-1px);
    }
    .pdot.is-active svg{ opacity: 1; }

    /* ドック（メインと同じサイズ・同じ.iconを使う＝サイズ一致） */
    .dock{
      padding: 12px;
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.08));
      backdrop-filter: blur(18px);
      box-shadow: 0 18px 50px rgba(0,0,0,.30);
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--dock-gap);
    }

    /* ===== モダール ===== */
    .overlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.0);
      backdrop-filter: blur(0px);
      display:none;
      z-index: 999;
    }
    .overlay.is-open{ display:block; }

    .modal{
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 10px; height: 10px;
      border-radius: 18px;
      background: rgba(20,24,32,.78);
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:none;
    }
    .modal.is-open{ display:block; }

    .modal__top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 14px 14px 10px;
      gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
    }
    .modal__title{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .modal__badge{
      width: 34px; height: 34px;
      border-radius: 12px;
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.14);
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      overflow:hidden;
    }
    .modal__badge svg{ width: 18px; height: 18px; display:block; }
    .modal__badge img{ width: 18px; height: 18px; display:block; object-fit:contain; }

    .modal__title h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.02em;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .modal__title p{
      margin:2px 0 0;
      font-size: 12px;
      color: rgba(255,255,255,.70);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-size: 12px;
    }

    .modal__body{
      padding: 14px 14px 18px;
      height: calc(100% - 56px);
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .card{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 14px;
      margin: 0 0 12px;
    }
    .card h3{ margin:0 0 8px; font-size: 13px; letter-spacing:.02em; }
    .card p{ margin:0; font-size: 13px; line-height: 1.7; color: rgba(255,255,255,.84); }
    .list{ margin: 10px 0 0; padding-left: 18px; color: rgba(255,255,255,.82); line-height: 1.8; font-size: 13px; }

    /* ★スマホ：フル画面（縦横100%固定 / ページはスクロールさせない） */
    @media (max-width: 540px){
      html, body{
        height: 100%;
        overflow: hidden;
      }

      body{
        padding: 0;
        background: #080a10;
        align-items: stretch;
        overscroll-behavior: none;
        position: fixed;
        inset: 0;
        width: 100%;
      }

      .shell{
        width: 100%;
        height: calc(var(--vh, 1vh) * 100);
        border-radius: 0;
        border: none;
        box-shadow: none;
      }

      .home{
        height: calc(calc(var(--vh, 1vh) * 100) - 48px);
        min-height: 0;
        overflow: hidden;
      }

      .pager{
        flex: 1 1 auto;
        min-height: 0;
        overflow: hidden;
      }

      .pages{
        height: 100%;
        overflow-y: hidden;
        cursor: auto;
      }

      .page{ height: 100%; }
    }

    @media (prefers-reduced-motion: reduce){
      .pages{ scroll-behavior:auto; }
      .pdot{ transform:none !important; }
    }

    /* ★閉じる時：中身を先に消す（ボタンが残って見えるのを防止） */
    .modal.is-closing .modal__top,
    .modal.is-closing .modal__body{
      opacity: 0;
      transform: translateY(-8px);
      transition: opacity 120ms linear, transform 120ms ease;
    }
    .modal .modal__top,
    .modal .modal__body{
      opacity: 1;
      transform: none;
    }
  </style>
</head>

<body>
  <main class="shell" aria-label="ホーム">
    <div class="statusbar">
      <div class="brand">nana marche</div>
      <div class="status-right">
        <span>Wi-Fi</span><span>100%</span><span class="dot" aria-hidden="true"></span>
      </div>
    </div>

    <section class="home">
      <div class="pager">
        <div class="pages" id="pages" aria-label="ページ">

          <!-- Page 1 -->
          <div class="page">
            <div class="grid">
              <button class="app" data-app="about"><div class="icon"><span class="svgicon" data-icon="about"></span></div><div class="label">About</div></button>
              <button class="app" data-app="service"><div class="icon"><span class="svgicon" data-icon="service"></span></div><div class="label">Service</div></button>
              <button class="app" data-app="works"><div class="icon"><span class="svgicon" data-icon="works"></span></div><div class="label">Works</div></button>
            </div>
          </div>

          <!-- Page 2 -->
          <div class="page">
            <div class="grid">
              <button class="app" data-app="news"><div class="icon"><span class="svgicon" data-icon="news"></span></div><div class="label">News</div></button>
              <button class="app" data-app="price"><div class="icon"><span class="svgicon" data-icon="price"></span></div><div class="label">Pricing</div></button>
              <button class="app" data-app="faq"><div class="icon"><span class="svgicon" data-icon="faq"></span></div><div class="label">FAQ</div></button>
              <button class="app" data-app="contact"><div class="icon"><span class="svgicon" data-icon="contact"></span></div><div class="label">Contact</div></button>

              <button class="app" data-app="access"><div class="icon"><span class="svgicon" data-icon="access"></span></div><div class="label">Access</div></button>
              <button class="app" data-app="blog"><div class="icon"><span class="svgicon" data-icon="blog"></span></div><div class="label">Blog</div></button>
              <button class="app" data-app="team"><div class="icon"><span class="svgicon" data-icon="team"></span></div><div class="label">Team</div></button>
              <button class="app" data-app="recruit"><div class="icon"><span class="svgicon" data-icon="recruit"></span></div><div class="label">Recruit</div></button>

              <button class="app" data-app="legal"><div class="icon"><span class="svgicon" data-icon="legal"></span></div><div class="label">Legal</div></button>
              <button class="app" data-app="feature"><div class="icon"><span class="svgicon" data-icon="feature"></span></div><div class="label">Feature</div></button>
              <button class="app" data-app="campaign"><div class="icon"><span class="svgicon" data-icon="campaign"></span></div><div class="label">Campaign</div></button>
              <button class="app" data-app="plan"><div class="icon"><span class="svgicon" data-icon="plan"></span></div><div class="label">Plan</div></button>

              <button class="app" data-app="review"><div class="icon"><span class="svgicon" data-icon="review"></span></div><div class="label">Review</div></button>
            </div>
          </div>

          <!-- Page 3 -->
          <div class="page">
            <div class="grid">
              <button class="app" data-app="tips"><div class="icon"><span class="svgicon" data-icon="tips"></span></div><div class="label">Tips</div></button>
              <button class="app" data-app="guide"><div class="icon"><span class="svgicon" data-icon="guide"></span></div><div class="label">Guide</div></button>
              <button class="app" data-app="docs"><div class="icon"><span class="svgicon" data-icon="docs"></span></div><div class="label">Docs</div></button>
              <button class="app" data-app="support"><div class="icon"><span class="svgicon" data-icon="support"></span></div><div class="label">Support</div></button>

              <button class="app" data-app="bonus"><div class="icon"><span class="svgicon" data-icon="bonus"></span></div><div class="label">Bonus</div></button>
              <button class="app" data-app="stats"><div class="icon"><span class="svgicon" data-icon="stats"></span></div><div class="label">Stats</div></button>
              <button class="app" data-app="lead"><div class="icon"><span class="svgicon" data-icon="lead"></span></div><div class="label">Lead</div></button>
              <button class="app" data-app="settings"><div class="icon"><span class="svgicon" data-icon="settings"></span></div><div class="label">Settings</div></button>
            </div>
          </div>

        </div>
      </div>

      <div class="bottom">
        <div class="dots" id="dots" aria-label="ページインジケータ"></div>

        <div class="dock" aria-label="ドック">
          <button class="app" data-app="tel"><div class="icon"><span class="svgicon" data-icon="tel"></span></div><div class="label">Call</div></button>
          <button class="app" data-app="chat"><div class="icon"><span class="svgicon" data-icon="chat"></span></div><div class="label">Chat</div></button>
          <button class="app" data-app="map"><div class="icon"><span class="svgicon" data-icon="map"></span></div><div class="label">Map</div></button>
          <button class="app" data-app="mail"><div class="icon"><span class="svgicon" data-icon="mail"></span></div><div class="label">Mail</div></button>
        </div>
      </div>
    </section>
  </main>

  <div class="overlay" id="overlay" aria-hidden="true"></div>

  <section class="modal" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <header class="modal__top">
      <div class="modal__title">
        <div class="modal__badge" id="modalBadge"></div>
        <div style="min-width:0">
          <h2 id="modalTitle">Title</h2>
          <p id="modalSub">Sub</p>
        </div>
      </div>
      <button class="btn" id="closeBtn" type="button">閉じる</button>
    </header>
    <div class="modal__body" id="modalBody"></div>
  </section>

  <script>
    /* =========================
       Wallpaper
    ========================= */
    function setWallpaper(url){
      document.documentElement.style.setProperty("--wallpaper", url ? `url("${url}")` : 'url("")');
    }
    setWallpaper("wallpaper.jpg");

    // ★iOS対策：アドレスバーの伸縮で100vhがズレるのを防ぐ
    function setVhUnit(){
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty("--vh", `${vh}px`);
    }
    setVhUnit();
    window.addEventListener("resize", setVhUnit, { passive: true });
    window.addEventListener("orientationchange", setVhUnit, { passive: true });

    /* =========================================================
       ★差し替え前提：ICON_IMAGES にファイルを並べるだけ
       - PNGでもSVGでもOK（imgで読み込む）
       - 例： /icons/about.png  または /icons/about.svg
       - ファイルが無いキーは「プレースホルダSVG」で表示（保険）
    ========================================================= */
    const ICON_IMAGES = {
      // --- メイン ---
      about:    "icons/about.svg",
      service:  "icons/service.svg",
      works:    "icons/works.svg",
      news:     "icons/news.svg",
      price:    "icons/price.svg",
      faq:      "icons/faq.svg",
      contact:  "icons/contact.svg",
      access:   "icons/access.svg",
      blog:     "icons/blog.svg",
      team:     "icons/team.svg",
      recruit:  "icons/recruit.svg",
      legal:    "icons/legal.svg",

      feature:  "icons/feature.svg",
      campaign: "icons/campaign.svg",
      plan:     "icons/plan.svg",
      review:   "icons/review.svg",
      tips:     "icons/tips.svg",
      guide:    "icons/guide.svg",
      docs:     "icons/docs.svg",
      support:  "icons/support.svg",
      bonus:    "icons/bonus.svg",
      stats:    "icons/stats.svg",
      lead:     "icons/lead.svg",
      settings: "icons/settings.svg",

      // --- ドック ---
      tel:      "icons/tel.svg",
      chat:     "icons/chat.svg",
      map:      "icons/map.svg",
      mail:     "icons/mail.svg",
    };

    function placeholderSvg(){
      // 差し替え忘れが分かる用のプレースホルダ（適当カラフル）
      return `
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="3" y="3" width="18" height="18" rx="5" fill="rgba(255,255,255,.12)"/>
          <path d="M7 15l4-6 3 4 3-2" stroke="#8EECF5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="9" cy="9" r="1.5" fill="#FFD166"/>
          <circle cx="16.5" cy="7.5" r="1.3" fill="#EF476F"/>
        </svg>
      `;
    }

    function mountIcons(){
      document.querySelectorAll(".svgicon").forEach(el=>{
        const key = el.dataset.icon;
        const src = ICON_IMAGES[key];

        if(src){
          const alt = key;
          el.innerHTML = `<img src="${src}" alt="${alt}" draggable="false" loading="lazy">`;
        }else{
          el.innerHTML = placeholderSvg();
        }
      });
    }
    mountIcons();

    /* =========================
       Pagination Dots（SVGっぽ＋自動生成）
    ========================= */
    const pages = document.getElementById("pages");
    const dotsWrap = document.getElementById("dots");

    function dotSvg(a,b){
      const gid = "g" + Math.random().toString(16).slice(2);
      return `
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="${gid}" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="${a}"/>
              <stop offset="1" stop-color="${b}"/>
            </linearGradient>
          </defs>
          <circle cx="12" cy="12" r="6.5" fill="url(#${gid})"/>
          <circle cx="9" cy="10" r="1.3" fill="rgba(255,255,255,.85)"/>
        </svg>
      `;
    }

    const DOT_SVGS = [
      () => dotSvg("#06D6A0","#8EECF5"),
      () => dotSvg("#FFD166","#EF476F"),
      () => dotSvg("#C77DFF","#FFAFCC"),
      () => dotSvg("#118AB2","#FFD166"),
      () => dotSvg("#EF476F","#06D6A0"),
      () => dotSvg("#8EECF5","#C77DFF"),
    ];

    function buildDots(){
      dotsWrap.innerHTML = "";
      const pageCount = pages.querySelectorAll(".page").length;

      for(let i=0;i<pageCount;i++){
        const b = document.createElement("button");
        b.type = "button";
        b.className = "pdot" + (i===0 ? " is-active" : "");
        b.setAttribute("aria-label", `ページ${i+1}へ`);
        b.dataset.index = String(i);
        b.innerHTML = DOT_SVGS[i % DOT_SVGS.length]();
        b.addEventListener("click", () => {
          pages.scrollTo({ left: i * pages.clientWidth, behavior: "smooth" });
          setActiveDot(i);
        });
        dotsWrap.appendChild(b);
      }
    }

    function setActiveDot(idx){
      dotsWrap.querySelectorAll(".pdot").forEach((b,i)=>{
        b.classList.toggle("is-active", i===idx);
      });
    }

    function currentPageIndex(){
      const w = pages.clientWidth || 1;
      return Math.round(pages.scrollLeft / w);
    }

    buildDots();
    pages.addEventListener("scroll", () => {
      requestAnimationFrame(() => setActiveDot(currentPageIndex()));
    });

    window.addEventListener("resize", () => {
      const before = dotsWrap.querySelectorAll(".pdot").length;
      const now = pages.querySelectorAll(".page").length;
      if(before !== now) buildDots();
      setActiveDot(currentPageIndex());
    });

    /* =========================
       Modal
    ========================= */
    const overlay = document.getElementById("overlay");
    const modal = document.getElementById("modal");
    const closeBtn = document.getElementById("closeBtn");
    const modalTitle = document.getElementById("modalTitle");
    const modalSub = document.getElementById("modalSub");
    const modalBody = document.getElementById("modalBody");
    const modalBadge = document.getElementById("modalBadge");

    const CONTENT = {
      about:{ title:"About", sub:"このサイトについて", body:`<div class="card"><h3>About</h3><p>ここに内容。</p></div>`},
      service:{ title:"Service", sub:"提供内容", body:`<div class="card"><h3>Service</h3><p>ここに内容。</p></div>`},
      works:{ title:"Works", sub:"制作実績", body:`<div class="card"><h3>Works</h3><p>ここに内容。</p></div>`},
      news:{ title:"News", sub:"お知らせ", body:`<div class="card"><h3>News</h3><ul class="list"><li>更新1</li><li>更新2</li></ul></div>`},
      price:{ title:"Pricing", sub:"料金", body:`<div class="card"><h3>Pricing</h3><p>ここに内容。</p></div>`},
      faq:{ title:"FAQ", sub:"よくある質問", body:`<div class="card"><h3>FAQ</h3><p>ここに内容。</p></div>`},
      contact:{ title:"Contact", sub:"お問い合わせ", body:`<div class="card"><h3>Contact</h3><p>ここに内容。</p></div>`},
      access:{ title:"Access", sub:"アクセス", body:`<div class="card"><h3>Access</h3><p>ここに内容。</p></div>`},
      blog:{ title:"Blog", sub:"読みもの", body:`<div class="card"><h3>Blog</h3><p>ここに内容。</p></div>`},
      team:{ title:"Team", sub:"メンバー", body:`<div class="card"><h3>Team</h3><p>ここに内容。</p></div>`},
      recruit:{ title:"Recruit", sub:"採用", body:`<div class="card"><h3>Recruit</h3><p>ここに内容。</p></div>`},
      legal:{ title:"Legal", sub:"表記", body:`<div class="card"><h3>Legal</h3><p>ここに内容。</p></div>`},

      feature:{ title:"Feature", sub:"特徴", body:`<div class="card"><h3>Feature</h3><p>ここに内容。</p></div>`},
      campaign:{ title:"Campaign", sub:"キャンペーン", body:`<div class="card"><h3>Campaign</h3><p>ここに内容。</p></div>`},
      plan:{ title:"Plan", sub:"プラン", body:`<div class="card"><h3>Plan</h3><p>ここに内容。</p></div>`},
      review:{ title:"Review", sub:"レビュー", body:`<div class="card"><h3>Review</h3><p>ここに内容。</p></div>`},
      tips:{ title:"Tips", sub:"豆知識", body:`<div class="card"><h3>Tips</h3><p>ここに内容。</p></div>`},
      guide:{ title:"Guide", sub:"ガイド", body:`<div class="card"><h3>Guide</h3><p>ここに内容。</p></div>`},
      docs:{ title:"Docs", sub:"資料", body:`<div class="card"><h3>Docs</h3><p>ここに内容。</p></div>`},
      support:{ title:"Support", sub:"サポート", body:`<div class="card"><h3>Support</h3><p>ここに内容。</p></div>`},
      bonus:{ title:"Bonus", sub:"特典", body:`<div class="card"><h3>Bonus</h3><p>ここに内容。</p></div>`},
      stats:{ title:"Stats", sub:"実績", body:`<div class="card"><h3>Stats</h3><p>ここに内容。</p></div>`},
      lead:{ title:"Lead", sub:"導線", body:`<div class="card"><h3>Lead</h3><p>ここに内容。</p></div>`},
      settings:{ title:"Settings", sub:"設定", body:`<div class="card"><h3>Settings</h3><p>ここに内容。</p></div>`},

      tel:{ title:"Call", sub:"電話", body:`<div class="card"><h3>tel:</h3><p><a href="tel:0000000000" style="color:rgba(255,255,255,.92)">000-0000-0000</a></p></div>`},
      chat:{ title:"Chat", sub:"チャット", body:`<div class="card"><h3>Chat</h3><p>ここに内容。</p></div>`},
      map:{ title:"Map", sub:"地図", body:`<div class="card"><h3>Map</h3><p>ここに内容。</p></div>`},
      mail:{ title:"Mail", sub:"メール", body:`<div class="card"><h3>Mail</h3><p>ここに内容。</p></div>`},
    };

    let lastTrigger = null;
    let isOpen = false;
    let wasDragging = false;
    let suppressNextClick = false;

    const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    function rect(el){ return el.getBoundingClientRect(); }

    function setModalContent(key){
      const d = CONTENT[key] || {title:"", sub:"", body:""};
      modalTitle.textContent = d.title;
      modalSub.textContent = d.sub;
      modalBody.innerHTML = d.body;
      modalBody.scrollTop = 0;

      // ★バッジも画像優先（なければプレースホルダ）
      const src = ICON_IMAGES[key];
      modalBadge.innerHTML = src
        ? `<img src="${src}" alt="" draggable="false">`
        : placeholderSvg();
    }

    function openFrom(btn){
      if(isOpen) return;
      isOpen = true;
      modal.classList.remove("is-closing");
      lastTrigger = btn;

      setModalContent(btn.dataset.app);

      const icon = btn.querySelector(".icon");
      const from = rect(icon);

      const targetW = Math.min(390, window.innerWidth - 24);
      const targetH = Math.min(720, window.innerHeight - 40);
      const toLeft = (window.innerWidth - targetW) / 2;
      const toTop  = (window.innerHeight - targetH) / 2;

      overlay.classList.add("is-open");
      overlay.setAttribute("aria-hidden","false");

      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden","false");

      modal.style.left = from.left + "px";
      modal.style.top = from.top + "px";
      modal.style.width = from.width + "px";
      modal.style.height = from.height + "px";
      modal.style.borderRadius = "18px";

      closeBtn.focus({ preventScroll: true });

      if(prefersReducedMotion){
        overlay.style.background = "rgba(0,0,0,0.45)";
        overlay.style.backdropFilter = "blur(8px)";
        modal.style.left = toLeft + "px";
        modal.style.top = toTop + "px";
        modal.style.width = targetW + "px";
        modal.style.height = targetH + "px";
        modal.style.borderRadius = "24px";
        return;
      }

      const dur = 420;
      const easing = "cubic-bezier(.2,.9,.2,1)";

      overlay.animate(
        [
          { background: "rgba(0,0,0,0.0)", backdropFilter: "blur(0px)" },
          { background: "rgba(0,0,0,0.45)", backdropFilter: "blur(8px)" }
        ],
        { duration: dur, easing, fill: "forwards" }
      );

      modal.animate(
        [
          { left: from.left+"px", top: from.top+"px", width: from.width+"px", height: from.height+"px", borderRadius:"18px" },
          { left: toLeft+"px", top: toTop+"px", width: targetW+"px", height: targetH+"px", borderRadius:"24px" }
        ],
        { duration: dur, easing, fill: "forwards" }
      ).onfinish = () => {
        modal.style.left = toLeft + "px";
        modal.style.top = toTop + "px";
        modal.style.width = targetW + "px";
        modal.style.height = targetH + "px";
        modal.style.borderRadius = "24px";
      };
    }

    function hardClose(){
      overlay.classList.remove("is-open");
      overlay.style.background = "rgba(0,0,0,0.0)";
      overlay.style.backdropFilter = "blur(0px)";
      modal.classList.remove("is-open");
      modal.style.left = "0px";
      modal.style.top = "0px";
      modal.style.width = "10px";
      modal.style.height = "10px";
    }

    function closeToTrigger(){
      if(!isOpen) return;
      isOpen = false;

      modal.classList.add("is-closing");

      const btn = lastTrigger;
      const icon = btn?.querySelector(".icon");
      if(!icon){ hardClose(); return; }

      const from = rect(modal);
      const to = rect(icon);

      overlay.setAttribute("aria-hidden","true");
      modal.setAttribute("aria-hidden","true");

      if(prefersReducedMotion){
        hardClose();
        btn.focus({ preventScroll: true });
        return;
      }

      const dur = 360;
      const easing = "cubic-bezier(.2,.9,.2,1)";

      overlay.animate(
        [
          { background: "rgba(0,0,0,0.45)", backdropFilter: "blur(8px)" },
          { background: "rgba(0,0,0,0.0)", backdropFilter: "blur(0px)" }
        ],
        { duration: dur, easing, fill: "forwards" }
      );

      modal.animate(
        [
          { left: from.left+"px", top: from.top+"px", width: from.width+"px", height: from.height+"px", borderRadius:"24px" },
          { left: to.left+"px", top: to.top+"px", width: to.width+"px", height: to.height+"px", borderRadius:"18px" }
        ],
        { duration: dur, easing, fill: "forwards" }
      ).onfinish = () => {
        hardClose();
        modal.classList.remove("is-closing");
        btn.focus({ preventScroll: true });
      };
    }

    closeBtn.addEventListener("click", closeToTrigger);
    overlay.addEventListener("click", closeToTrigger);
    window.addEventListener("keydown", (e) => {
      if(!isOpen) return;
      if(e.key === "Escape"){ e.preventDefault(); closeToTrigger(); }
    });

    /* =========================
       Click → Modal（drag誤爆防止）
    ========================= */
    document.querySelector(".shell").addEventListener("click", (e) => {
      if(suppressNextClick){
        suppressNextClick = false;
        return;
      }
      if(wasDragging){
        e.preventDefault();
        e.stopPropagation();
        wasDragging = false;
        return;
      }
      const btn = e.target.closest(".app");
      if(!btn) return;
      openFrom(btn);
    });

    /* =========================
       全デバイス対応：どこ掴んでも横スライド（statusbar / dock は除外）
    ========================= */
    (() => {
      const dragArea = document.querySelector(".home");
      const DRAG_THRESHOLD = 8;
      const INTENT_THRESHOLD = 6;

      let isDown = false;
      let startX = 0, startY = 0;
      let startLeft = 0;
      let movedX = 0;
      let decided = false;
      let isHorizontal = false;
      let pendingApp = null;
      let pointerId = null;

      const isExcludedTarget = (t) => {
        if (t.closest(".statusbar")) return true;
        if (t.closest(".dock")) return true;
        if (t.closest(".pdot")) return true;
        return false;
      };

      dragArea.addEventListener("pointerdown", (e) => {
        if (isOpen) return;
        if (isExcludedTarget(e.target)) return;

        isDown = true;
        decided = false;
        isHorizontal = false;
        movedX = 0;
        wasDragging = false;

        startX = e.clientX;
        startY = e.clientY;
        startLeft = pages.scrollLeft;

        pendingApp = e.target.closest(".app") || null;

        pages.classList.add("is-dragging");

        pointerId = e.pointerId;
        dragArea.setPointerCapture(pointerId);
      }, { passive: false });

      dragArea.addEventListener("pointermove", (e) => {
        if (!isDown) return;
        if (pointerId !== null && e.pointerId !== pointerId) return;

        const dx = e.clientX - startX;
        const dy = e.clientY - startY;

        if (!decided) {
          if (Math.abs(dx) > INTENT_THRESHOLD || Math.abs(dy) > INTENT_THRESHOLD) {
            decided = true;
            isHorizontal = Math.abs(dx) >= Math.abs(dy);
          }
        }

        if (!isHorizontal) return;

        e.preventDefault();

        movedX = Math.max(movedX, Math.abs(dx));
        pages.scrollLeft = startLeft - dx;

        if (movedX > DRAG_THRESHOLD) {
          wasDragging = true;
        }
      }, { passive: false });

      const end = (e) => {
        if (!isDown) return;
        if (pointerId !== null && e.pointerId !== pointerId) return;

        isDown = false;
        pages.classList.remove("is-dragging");

        try { dragArea.releasePointerCapture(pointerId); } catch(_){}
        pointerId = null;

        if (pendingApp && !wasDragging) {
          openFrom(pendingApp);
          suppressNextClick = true;
        }
        pendingApp = null;

        if (wasDragging) {
          setTimeout(() => (wasDragging = false), 0);
        }
      };

      dragArea.addEventListener("pointerup", end);
      dragArea.addEventListener("pointercancel", end);
    })();

    /* iOS Safari 完全フォールバック（touch） */
    (() => {
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
      if (!isIOS) return;

      const dragArea = document.querySelector(".home");
      const DRAG_THRESHOLD = 10;
      const INTENT_THRESHOLD = 6;

      let startX = 0, startY = 0;
      let startLeft = 0;
      let movedX = 0;
      let decided = false;
      let isHorizontal = false;
      let isTouching = false;
      let pendingApp = null;

      const isExcludedTarget = (t) => {
        if (t.closest(".statusbar")) return true;
        if (t.closest(".dock")) return true;
        if (t.closest(".pdot")) return true;
        return false;
      };

      dragArea.addEventListener("touchstart", (e) => {
        if (isOpen) return;
        const t = e.target;
        if (isExcludedTarget(t)) return;

        const touch = e.touches[0];
        isTouching = true;
        decided = false;
        isHorizontal = false;
        movedX = 0;
        wasDragging = false;

        startX = touch.clientX;
        startY = touch.clientY;
        startLeft = pages.scrollLeft;

        pendingApp = t.closest(".app") || null;
      }, { passive: true });

      dragArea.addEventListener("touchmove", (e) => {
        if (!isTouching) return;
        const touch = e.touches[0];

        const dx = touch.clientX - startX;
        const dy = touch.clientY - startY;

        if (!decided) {
          if (Math.abs(dx) > INTENT_THRESHOLD || Math.abs(dy) > INTENT_THRESHOLD) {
            decided = true;
            isHorizontal = Math.abs(dx) >= Math.abs(dy);
          }
        }

        if (!isHorizontal) return;

        e.preventDefault();

        movedX = Math.max(movedX, Math.abs(dx));
        pages.scrollLeft = startLeft - dx;

        if (movedX > DRAG_THRESHOLD) {
          wasDragging = true;
        }
      }, { passive: false });

      dragArea.addEventListener("touchend", () => {
        if (!isTouching) return;
        isTouching = false;

        if (pendingApp && !wasDragging) {
          openFrom(pendingApp);
          suppressNextClick = true;
        }
        pendingApp = null;

        if (wasDragging) {
          setTimeout(() => (wasDragging = false), 0);
        }
      });

      dragArea.addEventListener("touchcancel", () => {
        isTouching = false;
        pendingApp = null;
      });
    })();
  </script>
</body>
</html>
